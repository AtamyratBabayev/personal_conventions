# Конвенция по работе с GIT

[Ссылка на иллюстрацию](https://excalidraw.com/#json=f1Z9urUDq8WMhVuz0y_5F,25y91aNTGg1Q3TAirIQOKA)

Данная схема иллюстрирует рабочий процесс Git Flow, который разделяет ветки для разработки, исправлений, релизов и стабилизации, позволяя удобно управлять версиями проекта.

## Типы веток

- **Long Life Branch (LLB)**  
  Тип веток, которые могут существовать долгое время. К таким веткам относятся `main` (master), `development` и т.д. При обычных сценариях от этих веток происходит наследование веток с более коротким жизненным сроком.

- **Short Life Branch (SLB)**  
  Тип веток, которые создаются на определённое время и решают конкретные задачи. К ним относятся ветки фич, ветки фиксов и т.д.

- **Main branch**  
  Основная LLB ветка, содержащая стабильную версию кода.

- **Staging branch**  
  Промежуточная SLB ветка, соединяющая ветки `main` и `dev`. Используется тестировщиками.

- **Dev branch**  
  LLB ветка, в которой происходит основная разработка.

- **Feature branch**  
  SLB ветка, создаваемая для введения улучшения или добавления нового функционала.

- **Fix branch**  
  SLB ветка с кодом для исправлений.

## Основные потоки (flows) на схеме

- **Feature flow** – добавление нового или улучшение функционала.  
  - Ветки feature создаются из ветки `dev`.  
  - После завершения работы объединяются обратно в `dev` через Squash Merge.

- **Bugfix flow** – исправление ошибок в коде.  
  - Ветки bugfix могут быть созданы из `dev` или `staging`.  
  - Объединяются обратно в `dev` или `staging` через Squash Merge.

- **Release flow** – создание релизной версии приложения.  
  - Подготовка к релизу проходит в `staging`, куда включаются изменения из `dev` и создаются релизные коммиты (например, изменение версии приложения).  
  - После тестирования изменения из `staging` отправляются в `main` через Rebase Merge.  
  - В `dev` могут влиться обновления из `main` или `staging` также через Rebase Merge.

- **Quick Fix Flow** – срочное исправление ошибок.  
    - Ветка создаётся из `main`.  
    - После исправления изменения сливаются обратно в `main`, а затем в другие ветки (`dev` и т.д.).

## Правила наименования веток

Наименование веток должно включать номер тикета (например, `FA-1345`), тип задачи и краткое описание.

### Типы задач

| Тип задачи | Назначение                              |
|------------|---------------------------------------|
| `feat/`    | Для разработки новых функциональностей|
| `fix/`     | Для исправления багов (включая срочные исправления) |
| `release/` | Для подготовки релизов                 |
| `chore/`   | Для задач, не связанных с функционалом (например, обновление зависимостей) |
| `exp/`     | Для экспериментов                     |

### Формат названия ветки

<тип-задачи>/<номер-тикета>-<краткое-описание>


### Примеры

- Для новой функциональности:  
  `feat/fa-1345-add-user-login`

- Для исправления бага:  
  `fix/fa-1420-fix-header-alignment`

- Для подготовки релиза:  
  `release/1.3.0`

- Для задачи без пользовательского функционала:  
  `chore/fa-1500-update-dependencies`

- Для эксперимента:  
  `exp/fa-1603-test-new-ui-framework`

## Правила наименований коммитов

Коммиты должны быть понятными, лаконичными и следовать единому стилю. Обязательным элементом является номер тикета (например, `FA-1234`) и краткое описание изменений.

### Формат коммита

<номер-тикета>: <краткое-описание>


### Рекомендации

- Используйте глаголы в повелительном наклонении (`add`, `fix`, `update` и т.п.).
- Кратко и понятно описывайте изменения.

### Примеры

* XF-1234: Add user authentication
* XF-5678: Resolve issue with login form alignment
* XF-9012: Update dependencies to latest versions
* XF-3456: Add API documentation for login endpoint


---

## Подходы к управлению версиями Android и iOS

### Синхронизация версий через единую кодовую базу

- Храните версии Android и iOS отдельно в конфигурационных файлах:
  - Android: `android/app/build.gradle`
  - iOS: `ios/Runner.xcodeproj/project.pbxproj`
- Пример версий:
  - Android: `androidVersionCode` и `androidVersionName`
  - iOS: `CFBundleShortVersionString` и `CFBundleVersion`
- Обновляйте версии для каждой платформы независимо, но не разделяйте ветки для этого.

### Использование тегов для обозначения версий платформ

- Вместо разделения веток используйте теги:
  - Для Android: `v1.0.0-android`
  - Для iOS: `v1.0.0-ios`

### Порядок действий для релиза

```bash
git tag -a v1.0.0-android -m "Release for Android"
git tag -a v1.0.0-ios -m "Release for iOS"
git push origin --tags
```

Такой подход позволяет создавать сборки на основе тегов с помощью CI/CD.

### Интеграция с CI/CD

Рекомендуемые инструменты для организации процесса доставки:

* FastLane + Github Actions* 
* CodeMagic + Github Actions* 
* CodeMagic с прослушиванием репозитория